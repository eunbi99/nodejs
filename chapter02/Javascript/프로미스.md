# ğŸ’» í”„ë¡œë¯¸ìŠ¤
- ìë°”ìŠ¤í¬ë¦½íŠ¸ì™€ ë…¸ë“œì—ì„œëŠ” ì£¼ë¡œ ë¹„ë™ê¸°ë¥¼ ì ‘í•œë‹¤.
- íŠ¹íˆ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì‚¬ìš©í•  ë•Œ ì½œë°± í•¨ìˆ˜ë¥¼ ìì£¼ ì‚¬ìš©í•œë‹¤.
- ES2015ë¶€í„°ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ì™€ ë…¸ë“œì˜ APIë“¤ì´ ì½œë°± ëŒ€ì‹  í”„ë¡œë¯¸ìŠ¤(Promise)ê¸°ë°˜ìœ¼ë¡œ ì¬êµ¬ì„±ë˜ë©° ì½œë°± ì§€ì˜¥ í˜„ìƒì„ ê·¹ë³µí–ˆë‹¤.

```
state : pendfing -> fulfilled or reject
Producer vs Consumer
```

## ğŸ“Œ Producer
#### `resolve`
>ê¸°ëŠ¥ì„ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰í•´ì„œ ë§ˆì§€ë§‰ì— ìµœì¢… ë°ì´í„°ë¥¼ ì „ë‹¬
#### `reject`
>ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ë‹¤ê°€ ì¤‘ê°„ì— ë¬¸ì œê°€ ìƒê¸°ë©´ í˜¸ì¶œ

```
const promise = new Promise((resolve, reject) =>{
  console.log('doing something...');
  setTimeout(() => {
    1ï¸âƒ£resolve('eunbi'); 
    2ï¸âƒ£reject(new Error('no network'));
   
  },2000);
});
```

## ğŸ“Œ Comsumers : then, catch , finally
1ï¸âƒ£promiseê°€ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰ë˜ì–´ì„œ resolve ì½œë°±í•¨ìˆ˜ì—ì„œ ì „ë‹¬ëœ ê°’(eunbi)ê°€ ë“¤ì–´ì˜´ <br>
2ï¸âƒ£ì‹¤íŒ¨ì‹œ 'no network' ë¼ëŠ” ì—ëŸ¬ë°œìƒ<br>
#### `finally` 
>ì„±ê³µ/ ì‹¤íŒ¨ ìƒê´€ì—†ì´ í•­ìƒ ì‹¤í–‰
```
promise.
then((value) => {
  console.log(value);
})
.catch(error=>{
  console.log(error);
})
.finally(()=> {console.log('finally');
});
```

## ğŸ“Œ Promise chanining 
```
const fetchNumber = new Promise((resolve,reject)=>{
  setTimeout(()=> resolve(1),1000); // í”„ë¡œë¯¸ìŠ¤ ì„±ê³µì‹œ 1ì´ˆ í›„ 1 ì „ë‹¬
});

fetchNumber
.then(num => num*2) // ì „ë‹¬ëœ 1*2 =2
.then(num => num*3) // ì „ë‹¬ëœ 2*3 =6
.then(num => {
  return new Promise((resolve,reject)=>{ //ìƒˆë¡œìš´ í”„ë¡œë¯¸ìŠ¤
    setTimeout(()=> resolve(num - 1),1000); // ì „ë‹¬ëœ 6-1 =5
  });
})
.then(num => console.log(num)); // 2ì´ˆ í›„ 5ê°€ ì¶œë ¥ëœë‹¤
```

## ğŸ“Œ Error Handling
```
const getHen = () => 
  new Promise((resolve, reject)=>{
    setTimeout(() => resolve('ğŸ“'), 1000);
  });

const getEgg = hen => 
  new Promise((resolve, reject)=>{
    setTimeout(() => reject(new Error(`error! ${hen} =>ğŸ¥š`)), 1000);
  });

const cook = egg => 
  new Promise((resolve, reject)=>{
    setTimeout(() => resolve(`${egg} => ğŸ³`), 1000);
  });

getHen()
  .then(getEgg)
  .catch(error => {
    return 'ğŸ¥'; 
  })
  .then(cook)
  .then(console.log)
  .catch(console.log);
```

### ğŸŒŠì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ì‹œ nameê³¼ role ì¶œë ¥
```
class UserStorage{
  loginUser(id,password){
    return new Promise((resolve,reject) => {
      setTimeout(()=>{
        if(
          (id === 'eunbi' && password === '1234') ||
          (id === 'coder' && password === '2345')
        ) {
          resolve(id);
        }else{
          reject(new Error('not found'));
        }
      },2000);
      });
}

getRoles(user) {
  return new Promise((resolve,reject) => {
    setTimeout(()=>{
      if(user === 'eunbi'){
        resolve({ name : 'eunbi', role : 'admin'});
      }else{
        reject(new Error('no access'));
      }
     },1000);
   });
  }
}

const userStorage = new UserStorage();
const id = prompt('enter your id');
const password = prompt('enter your password');
userStorage.loginUser(id,password)
  .then(userStorage.getRoles)
  .then(user => alert(`Hello ${user.name}, you have a ${user.role} role`))
  .catch(console.log);
```

